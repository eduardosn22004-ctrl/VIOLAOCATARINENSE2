---
import Layout from '../layouts/Layout.astro';

// --- BANCO DE DADOS DOS MÚSICOS ---
// Adicione quantos quiser aqui. O ID deve ser único (sem espaços).
const musicos = [
  {
    id: "edino-krieger",
    nome: "Edino Krieger",
    foto: "/images/edino.jpg", // Certifique-se que a imagem existe
    bio: `
      <p>Nascido em Brusque (SC) em 1928, Edino Krieger é um dos nomes mais importantes da música brasileira contemporânea.</p>
      <p class="mt-4">Compositor, produtor e crítico musical, suas obras para violão são tocadas no mundo todo. Foi o grande incentivador deste projeto.</p>
      <p class="mt-4">Suas principais obras incluem a Rítmica e a Suíte para Violão Solo.</p>
    `,
    galeria: [
      "/images/edino.jpg",
    ]
  },
  {
    id: "corgi",
    nome: "Corgi",
    foto: "/images/corgi.jpg", // Imagem temporária
    bio: `
      <p>Aqui vai a biografia detalhada do segundo compositor.</p>
      <p class="mt-4">Você pode escrever vários parágrafos aqui.</p>
    `,
    galeria: [
       "/images/logo.png"
    ]
  },
  // Copie e cole o bloco acima para adicionar mais pessoas
];

// --- ORDENAÇÃO AUTOMÁTICA (A a Z) ---
// Esta linha organiza a lista automaticamente antes de mostrar na tela
musicos.sort((a, b) => a.nome.localeCompare(b.nome));
---

<Layout title="Violão Catarinense">
    
    <div class="text-center mb-16">
    <h1 class="text-4xl font-bold text-red-700 mb-4">
        Compositores e Violonistas
    </h1>
    <p class="text-xl mb-16 text-stone-800 font-normal">
        Para conhecer os compositores e violonistas contribuentes para o repertório 
        violonístico no estado de Santa Catarina, acesse a lista abaixo.
    </p>
           

        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
            {musicos.map((musico) => (
                <div class="group cursor-pointer transform transition-all hover:-translate-y-2" onclick={`abrirModal('${musico.id}')`}>
                    
                    <div class="overflow-hidden rounded-xl shadow-md aspect-[3/4] mb-4 relative bg-gray-100">
                        <img 
                            src={musico.foto} 
                            alt={musico.nome} 
                            class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                            loading="lazy"
                        />
                        <div class="absolute inset-0 bg-rose-900/0 group-hover:bg-rose-900/20 transition-colors duration-300"></div>
                    </div>

                    <h3 class="text-xl font-bold text-center text-gray-800 group-hover:text-rose-700 transition-colors">
                        {musico.nome}
                    </h3>
                    <p class="text-sm text-center text-gray-500 mt-1">Clique para ver bio</p>

                    <div id={`data-${musico.id}`} class="hidden">
                        <span class="data-nome">{musico.nome}</span>
                        <span class="data-foto">{musico.foto}</span>
                        <div class="data-bio flex flex-col gap-2 text-justify" set:html={musico.bio}></div>
                    </div>

                </div>
            ))}
        </div>

    </div>

    <div id="modal-overlay" class="fixed inset-0 z-50 hidden bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 opacity-0 transition-opacity duration-300">
        
        <div class="bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto shadow-2xl relative transform scale-95 transition-transform duration-300" id="modal-content">
            
            <button onclick="fecharModal()" class="absolute top-4 right-4 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-full p-2 transition-colors z-10">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>

            <div class="grid grid-cols-1 md:grid-cols-2">
                
                <div class="bg-gray-100 p-6 flex flex-col items-center justify-center min-h-[300px]">
                    <img id="modal-img" src="" alt="" class="w-full max-w-sm rounded-lg shadow-lg object-cover" />
                    
                    <p class="text-sm text-gray-400 mt-4 italic">Galeria de fotos</p>
                    <div class="flex gap-2 mt-2">
                        <div class="w-3 h-3 rounded-full bg-rose-600"></div>
                        <div class="w-3 h-3 rounded-full bg-gray-300"></div>
                    </div>
                </div>

                <div class="p-8 md:p-10">
                    <h2 id="modal-title" class="text-3xl font-bold text-gray-900 mb-6 border-b border-rose-100 pb-4">
                        Nome do Compositor
                    </h2>
                    
                    <div id="modal-bio" class="text-lg text-gray-700 leading-relaxed space-y-4">
                        </div>
                </div>

            </div>
        </div>
    </div>

</Layout>

<script is:inline>
    const modalOverlay = document.getElementById('modal-overlay');
    const modalContent = document.getElementById('modal-content');
    
    // Elementos internos do modal para preencher
    const modalTitle = document.getElementById('modal-title');
    const modalImg = document.getElementById('modal-img');
    const modalBio = document.getElementById('modal-bio');

    // Função para ABRIR
    window.abrirModal = (id) => {
        // 1. Busca os dados escondidos no card que foi clicado
        const dataDiv = document.getElementById(`data-${id}`);
        // Segurança: se não achar, para aqui
        if (!dataDiv) return;

        const nome = dataDiv.querySelector('.data-nome').innerText;
        const foto = dataDiv.querySelector('.data-foto').innerText;
        const bioHtml = dataDiv.querySelector('.data-bio').innerHTML;

        // 2. Preenche o Modal
        modalTitle.innerText = nome;
        modalImg.src = foto;
        modalBio.innerHTML = bioHtml;

        // 3. Mostra o Modal (Tira o hidden e anima a opacidade)
        modalOverlay.classList.remove('hidden');
        // Pequeno delay para a animação CSS funcionar
        setTimeout(() => {
            modalOverlay.classList.remove('opacity-0');
            modalContent.classList.remove('scale-95');
            modalContent.classList.add('scale-100');
        }, 10);
        
        // Trava a rolagem da página de fundo
        document.body.style.overflow = 'hidden';
    }

    // Função para FECHAR
    window.fecharModal = () => {
        // Animação de saída
        modalOverlay.classList.add('opacity-0');
        modalContent.classList.remove('scale-100');
        modalContent.classList.add('scale-95');

        setTimeout(() => {
            modalOverlay.classList.add('hidden');
            // Destrava a rolagem
            document.body.style.overflow = 'auto';
        }, 300); // Espera 300ms (tempo da transição CSS)
    }

    // Fechar se clicar fora da caixa branca (no fundo preto)
    modalOverlay.addEventListener('click', (e) => {
        if (e.target === modalOverlay) {
            fecharModal();
        }
    });

    // Fechar com ESC (Melhoria de usabilidade)
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !modalOverlay.classList.contains('hidden')) {
            fecharModal();
        }
    });
</script>
